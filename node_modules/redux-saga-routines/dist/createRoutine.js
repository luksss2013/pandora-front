"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createRoutine;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _reduxActions = require("redux-actions");

var _routineStages = _interopRequireDefault(require("./routineStages"));

var isFunction = function isFunction(value) {
  return typeof value === 'function';
};

function createRoutine(typePrefix, payloadCreator, metaCreator) {
  var getCreatorForType = function getCreatorForType(type, creator) {
    if (!creator) {
      return creator;
    }

    if (isFunction(creator[type])) {
      return creator[type];
    }

    if (isFunction(creator[type.toLowerCase()])) {
      return creator[type.toLowerCase()];
    }

    if (isFunction(creator)) {
      return creator;
    }

    return undefined;
  };

  var createActionCreator = function createActionCreator(type) {
    return (0, _reduxActions.createAction)("".concat(typePrefix, "/").concat(type), getCreatorForType(type, payloadCreator), getCreatorForType(type, metaCreator));
  };

  return _routineStages.default.reduce(function (result, stage) {
    var _Object$assign;

    var actionCreator = createActionCreator(stage);
    return Object.assign(result, (_Object$assign = {}, (0, _defineProperty2.default)(_Object$assign, stage.toLowerCase(), actionCreator), (0, _defineProperty2.default)(_Object$assign, stage.toUpperCase(), actionCreator.toString()), _Object$assign));
  }, createActionCreator(_routineStages.default[0]));
}